# You should replace these 3 lines with the output in calibration step


import numpy as np
import cv2
import sys
import os

""" LEFT
DIM=(1920, 1080)
K=np.array([[386.86272580887766, 0.0, 961.3496948184803], [0.0, 386.4098425816344, 507.1367485438685], [0.0, 0.0, 1.0]])
D=np.array([[0.025075441107852738], [-0.026474731140917737], [0.02878644374021592], [-0.011533604444589816]])
"""

""" RIGHT
DIM=(1920, 1080)
K=np.array([[386.49404392457035, 0.0, 950.7834022296813], [0.0, 386.17955232335163, 534.966578693153], [0.0, 0.0, 1.0]])
D=np.array([[0.027946380281796915], [-0.02052588351194629], [0.015438289890456498], [-0.005880227411641979]])
"""

""" LEFT V2
DIM=(1920, 1080)
K=np.array([[390.04427555700215, 0.0, 961.6136195957941], [0.0, 389.91220362222515, 508.6686936437803], [0.0, 0.0, 1.0]])
D=np.array([[0.025635339869543264], [-0.037264630055349614], [0.03804086063442726], [-0.01399852912413158]])
"""

""" RIGHT V2
DIM=(1920, 1080)
K=np.array([[386.386322313026, 0.0, 950.8192461891825], [0.0, 386.0537491228412, 534.9458738253207], [0.0, 0.0, 1.0]])
D=np.array([[0.028665799058537656], [-0.022179141581777077], [0.017364406587187752], [-0.006659607916889329]])
"""


"""
RIGHT V3
DIM=(1920, 1080)
K=np.array([[383.79819905045014, 0.0, 950.841380203322], [0.0, 383.68682183155533, 538.7921696730444], [0.0, 0.0, 1.0]])
D=np.array([[0.026925685740203802], [-0.018518059358608334], [0.009094269262267371], [-0.001960963690379811]])
"""
""""""
DIM=(1920, 1080)
KL=np.array([[386.86272580887766, 0.0, 961.3496948184803], [0.0, 386.4098425816344, 507.1367485438685], [0.0, 0.0, 1.0]])
DL=np.array([[0.025075441107852738], [-0.026474731140917737], [0.02878644374021592], [-0.011533604444589816]])

KR=np.array([[386.386322313026, 0.0, 950.8192461891825], [0.0, 386.0537491228412, 534.9458738253207], [0.0, 0.0, 1.0]])
DR=np.array([[0.028665799058537656], [-0.022179141581777077], [0.017364406587187752], [-0.006659607916889329]])



DIM=(1920, 1080)
KL=np.array([[395.4530008616194, 0.0, 963.432229566367], [0.0, 395.83878152049635, 514.9656543995023], [0.0, 0.0, 1.0]])
DL=np.array([[0.03954210101929567], [-0.04414180964904044], [0.010031675245531085], [-0.006319647628990719]])


DIM=(1920, 1080)
KR=np.array([[383.73693323646796, 0.0, 950.8380618959513], [0.0, 383.60744219920514, 538.7646980955202], [0.0, 0.0, 1.0]])
DR=np.array([[0.02706025916829062], [-0.018673375073422746], [0.009177632228162414], [-0.001976113179652662]])


#def undistort(img_path):
#img_path=
imgL= cv2.imread('oneemL.png')
imgR = cv2.imread('oneemR.png')
h,w = imgL.shape[:2]
mapL, map2L = cv2.fisheye.initUndistortRectifyMap(KL, DL, np.eye(3), KL, DIM, cv2.CV_16SC2)
undistorted_imgL = cv2.remap(imgL, mapL, map2L, interpolation=cv2.INTER_LINEAR, borderMode=cv2.BORDER_CONSTANT)

mapR, map2R = cv2.fisheye.initUndistortRectifyMap(KR, DR, np.eye(3), KR, DIM, cv2.CV_16SC2)
undistorted_imgR = cv2.remap(imgR, mapR, map2R, interpolation=cv2.INTER_LINEAR, borderMode=cv2.BORDER_CONSTANT)

cv2.imshow("mul", undistorted_imgL)
cv2.imwrite('oneemLu.png',undistorted_imgL)

cv2.imshow("mur", undistorted_imgL)
cv2.imwrite('oneemRu.png',undistorted_imgR)

cv2.waitKey(0)
cv2.destroyAllWindows()
#if __name__ == '__main__':
 #   for p in sys.argv[1:]:
  #      undistort(p)